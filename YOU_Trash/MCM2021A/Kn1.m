function dx = Kn1(t,x,moist)    
%k1-k15=a12-a56
%k16-k21=b1-b6
%k22-k27=c1-c6
%k28=m
%x1-x6=Ni(t)
%x(7)=X(t)
tem=20;
k=[11.1754641930221,0.448686105634519,0.284404594181475,0.101572229422600,0.433724319874707,0.375706306906697,7.78360922590722,196.155902352536,4.48561078068846,10.1289501711480,0.149357085912281,0.144113989894085,5.00118229621533,5.56309405723828,15141.4066789916,0.000832291342798068,0.000372978650290851,2.87276900155679e-05,2.46397345476368e-06,0.0754900472640799,4.65735845147395e-07,1.39954913942399,0.863502851098493,0.450677313425956,0.0354558444768367,-0.370971205746716,-0.000738097638690110,-0.922173109510945];
dx=[x(1)*log(k(22)*x(7)/(x(1)+k(1)*x(2)+k(2)*x(3)+k(3)*x(4)+k(4)*x(5)+k(5)*x(6)-k(23)))
    x(2)*log(k(22)*x(7)/((1/k(1))*x(1)+x(2)+k(6)*x(3)+k(7)*x(4)+k(8)*x(5)+k(9)*x(6)-k(24)))
    x(3)*log(k(22)*x(7)/((1/k(2))*x(1)+(1/k(6))*x(2)+x(3)+k(10)*x(4)+k(11)*x(5)+k(12)*x(6)-k(25)))
    x(4)*log(k(22)*x(7)/((1/k(3))*x(1)+(1/k(7))*x(2)+(1/k(10))*x(3)+x(4)+k(13)*x(5)+k(14)*x(6)-k(26)))
    x(5)*log(k(22)*x(7)/((1/k(4))*x(1)+(1/k(8))*x(2)+(1/k(11))*x(3)+(1/k(13))*x(4)+x(5)+k(15)*x(6)-k(27)))
    x(6)*log(k(22)*x(7)/((1/k(5))*x(1)+(1/k(9))*x(2)+(1/k(12))*x(3)+(1/k(14))*x(4)+(1/k(15))*x(5)+x(6)-k(28)))
    -k(16)*x(1)*x(7)-k(17)*x(2)*x(7)-k(18)*x(3)*x(7)-k(19)*x(4)*x(7)-k(20)*x(5)*x(7)-k(21)*x(6)*x(7)
    ];
if tem<18
    dx(1)=dx(1)-(18-tem)/18*x(1);
    dx(2)=dx(2)-(24-tem)/24*x(2);
    dx(3)=dx(3)-(24-tem)/24*x(3);
    dx(4)=dx(4)-(27-tem)/27*x(4);
    dx(6)=dx(6)-(27-tem)/27*x(5);
elseif tem>=18 && tem<24
    dx(2)=dx(2)-(24-tem)/24*x(2);
    dx(3)=dx(3)-(24-tem)/24*x(3);
    dx(4)=dx(4)-(27-tem)/27*x(4);
    dx(6)=dx(6)-(27-tem)/27*x(5);
elseif tem>=24 && tem<27
    dx(4)=dx(4)-(27-tem)/27*x(4);
    dx(6)=dx(6)-(27-tem)/27*x(5);
end
if moist<96 && moist>69
    dx(6)=dx(6)-(96-moist)/96*x(6);
elseif moist<=69 && moist>=50
    dx(6)=dx(6)-(96-moist)/96*x(6);
    dx(4)=dx(4)-(69-moist)/69*x(4);
elseif moist<50 && moist>48
    dx(6)=dx(6)-(96-moist)/96*x(6);
    dx(4)=dx(4)-(69-moist)/69*x(4);
    dx(5)=dx(5)-(50-moist)/50*x(5);
elseif moist<=48 && moist>=27   
    dx(6)=dx(6)-(96-moist)/96*x(6);
    dx(4)=dx(4)-(69-moist)/69*x(4);
    dx(5)=dx(5)-(50-moist)/50*x(5);
    dx(3)=dx(3)-(48-moist)/48*x(3);
elseif moist<27
    dx(6)=dx(6)-(96-moist)/96*x(6);
    dx(4)=dx(4)-(69-moist)/69*x(4);
    dx(5)=dx(5)-(50-moist)/50*x(5);
    dx(3)=dx(3)-(48-moist)/48*x(3);
    dx(2)=dx(2)-(27-moist)/48*x(2);
end
